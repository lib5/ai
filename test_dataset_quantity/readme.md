# æµ‹è¯•æ•°æ®é›†å’Œè¯„ä¼°æµæ°´çº¿ - é¡¹ç›®è¯´æ˜

æœ¬ç›®å½•åŒ…å«äº†å®Œæ•´çš„è‡ªåŠ¨åŒ–æµ‹è¯•æ•°æ®é›†ã€è¯„ä¼°æµæ°´çº¿å’Œç›¸å…³å·¥å…·ã€‚

## ç›®å½•ç»“æ„

### ğŸ“ æ ¸å¿ƒç›®å½•

#### ğŸ“ raw_data/ - åŸå§‹æµ‹è¯•æ•°æ®
- **final_cast.json**: åŸºç¡€æµ‹è¯•ç”¨ä¾‹æ•°æ®ï¼ˆ17ä¸ªå•è½®æµ‹è¯•ï¼‰
- **final_cast_v2.json**: æ‰©å±•æµ‹è¯•ç”¨ä¾‹æ•°æ®ï¼ˆ74ä¸ªæµ‹è¯•ï¼ŒåŒ…å«å•è½®å’Œå¤šè½®ï¼‰
- **final_cast_v3-101.json**: æœ€æ–°ç‰ˆæœ¬æµ‹è¯•æ•°æ®ï¼ˆ101ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- **multi_turn_test_cases.json**: ä¸“é—¨çš„å¤šè½®å¯¹è¯æµ‹è¯•ç”¨ä¾‹

#### ğŸ“ images/ - æµ‹è¯•ç”¨å›¾ç‰‡èµ„æº
åŒ…å«æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¸­ä½¿ç”¨çš„å›¾ç‰‡ï¼š
- **ä¿®æ”¹äººè„‰.png**: è”ç³»äººä¿®æ”¹ç›¸å…³æµ‹è¯•
- **æ–°å¢äººè„‰.png**: æ–°å»ºè”ç³»äººæµ‹è¯•
- **å››ç‚¹å¼€ä¼š.png**: æ—¥ç¨‹åˆ›å»ºæµ‹è¯•
- **å‡ºå·®æé†’.png**: æé†’è®¾ç½®æµ‹è¯•
- **åˆ é™¤ä»»åŠ¡.png**: ä»»åŠ¡ç®¡ç†æµ‹è¯•
- **åç‰‡.png**: è”ç³»äººä¿¡æ¯æµ‹è¯•
- **å¸¦é½èµ„æ–™.png**: ä¼šè®®å‡†å¤‡æµ‹è¯•
- å…¶ä»–æ—¥ç¨‹ã€è”ç³»äººç›¸å…³çš„æµ‹è¯•å›¾ç‰‡

#### ğŸ“ pipline_results/ - æµæ°´çº¿æ‰§è¡Œç»“æœ
æ¯æ¬¡å®Œæ•´è¯„ä¼°æµæ°´çº¿çš„è¾“å‡ºç›®å½•ï¼š
- **runs_YYYYMMDD_HHMMSS/**: æŒ‰æ—¶é—´æˆ³ç»„ç»‡çš„è¿è¡Œç»“æœ
  - **logs/**: è¯¦ç»†æ‰§è¡Œæ—¥å¿—
  - **test_results_all_44_*.json**: æ­¥éª¤1çš„åŸå§‹æµ‹è¯•ç»“æœ
  - **test_results_merged_*.json**: æ­¥éª¤2çš„åˆå¹¶ç»“æœ
  - **validation_report_*.json**: æ­¥éª¤3çš„éªŒè¯æŠ¥å‘Š
  - **pipeline_summary_*.json**: æµæ°´çº¿æ±‡æ€»æŠ¥å‘Š

#### ğŸ“ validation_reports/ - éªŒè¯æŠ¥å‘Š
- **validation_report_*.json**: å„ç§éªŒè¯æŠ¥å‘Šæ–‡ä»¶
- æŒ‰æ¨¡å‹å’Œæ—¶é—´ç»„ç»‡ï¼šgeminiã€doubaoã€qwenç­‰

#### ğŸ“ logs/ - éªŒè¯æ—¥å¿—
- **validation_YYYYMMDD_HHMMSS.txt**: è¯¦ç»†çš„éªŒè¯è¿‡ç¨‹æ—¥å¿—
- åŒ…å«å‘é€ç»™æ¨¡å‹çš„promptå’ŒåŸå§‹å“åº”

#### ğŸ“ f1_score/ - F1åˆ†æ•°åˆ†æ
- **validation_f1_analysis_*.json**: F1åˆ†æ•°è®¡ç®—ç»“æœ
- ä¸‰ä¸ªæ¨¡å‹çš„å¯¹æ¯”åˆ†ææŠ¥å‘Š

#### ğŸ“ act_erro/ - é”™è¯¯æ¡ˆä¾‹
- **gemini_act_erro.json**: Geminiæ¨¡å‹çš„é”™è¯¯æ¡ˆä¾‹
- **doubao_act_erro.json**: Doubaoæ¨¡å‹çš„é”™è¯¯æ¡ˆä¾‹
- **qwen_act_err.json**: Qwenæ¨¡å‹çš„é”™è¯¯æ¡ˆä¾‹

---

### ğŸ› ï¸ æ ¸å¿ƒè„šæœ¬

#### ğŸ“œ test_all_cases.py - æµ‹è¯•æ‰§è¡Œè„šæœ¬
**åŠŸèƒ½**: æ‰§è¡Œæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹
**ç”¨æ³•**:
```bash
# æ‰§è¡Œå…¨éƒ¨æµ‹è¯•
python test_all_cases.py

# é™åˆ¶æµ‹è¯•æ•°é‡
python test_all_cases.py --limit 10

# æŒ‡å®šè¾“å…¥æ–‡ä»¶
python test_all_cases.py --input raw_data/final_cast_v2.json

# æŒ‡å®šè¾“å‡ºæ–‡ä»¶
python test_all_cases.py --output results.json
```

**è¾“å‡º**: ç”Ÿæˆ test_results_all_44_*.json æ–‡ä»¶

#### ğŸ“œ validate_test_gemini_results.py - GeminiéªŒè¯è„šæœ¬
**åŠŸèƒ½**: ä½¿ç”¨Geminiæ¨¡å‹éªŒè¯æµ‹è¯•ç»“æœ
**ç‰¹æ€§**:
- æ”¯æŒå¤šè·¯å¾„æœŸæœ›éªŒè¯
- è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼ˆé»˜è®¤5æ¬¡ï¼‰
- åªé‡è¯•éªŒè¯å¤±è´¥çš„ç”¨ä¾‹ï¼ˆstatus != "success"ï¼‰

**ç”¨æ³•**:
```bash
# éªŒè¯æœ€æ–°ç»“æœ
python validate_test_gemini_results.py

# è‡ªå®šä¹‰é‡è¯•æ¬¡æ•°
python validate_test_gemini_results.py --retry 3

# ç¦ç”¨é‡è¯•
python validate_test_gemini_results.py --no-retry

# æŒ‡å®šè¾“å…¥è¾“å‡º
python validate_test_gemini_results.py -i input.json -o report.json
```

**è¾“å‡º**: ç”Ÿæˆ validation_report_*.json æ–‡ä»¶

#### ğŸ“œ validate_test_gpt_results.py - GPTéªŒè¯è„šæœ¬
**åŠŸèƒ½**: ä½¿ç”¨Azure OpenAI GPT-4.1éªŒè¯æµ‹è¯•ç»“æœ
**ç‰¹æ€§**: ä¸GeminiéªŒè¯è„šæœ¬ç±»ä¼¼ï¼Œä½†ä½¿ç”¨GPTæ¨¡å‹

#### ğŸ“œ convert_stream_data.py - æ•°æ®è½¬æ¢è„šæœ¬
**åŠŸèƒ½**: å°†æµå¼æµ‹è¯•ç»“æœè½¬æ¢ä¸ºæ ‡å‡†æ ¼å¼
**è¾“å…¥**: test_results_all_44_*.json
**è¾“å‡º**: test_results_merged_*.json

#### ğŸ“œ run_evaluation_pipeline.py - æµæ°´çº¿ä¸»æ§è„šæœ¬
**åŠŸèƒ½**: ä¸€é”®è¿è¡Œå®Œæ•´è¯„ä¼°æµæ°´çº¿
**æ­¥éª¤**:
1. è¿è¡Œæµ‹è¯•ç”¨ä¾‹
2. åˆå¹¶æµå¼æ•°æ®
3. éªŒè¯æµ‹è¯•ç»“æœ
4. ç”Ÿæˆæ±‡æ€»æŠ¥å‘Š

**ç”¨æ³•**:
```bash
# è¿è¡Œå®Œæ•´æµæ°´çº¿
python run_evaluation_pipeline.py

# é™åˆ¶æµ‹è¯•æ•°é‡
python run_evaluation_pipeline.py --limit 10
```

#### ğŸ“œ calculate_validation_f1.py - F1åˆ†æ•°è®¡ç®—
**åŠŸèƒ½**: è®¡ç®—ä¸‰ä¸ªæ¨¡å‹çš„F1åˆ†æ•°å¯¹æ¯”
**è¾“å…¥**: validation_reports/ç›®å½•ä¸‹çš„æŠ¥å‘Š
**è¾“å‡º**: f1_score/validation_f1_analysis_*.json

---

### ğŸ“Š æµ‹è¯•æ•°æ®æ–‡ä»¶

#### ğŸ“‹ all_test_cases.json - å…¨éƒ¨æµ‹è¯•ç”¨ä¾‹
- åŒ…å«æ‰€æœ‰74ä¸ªæµ‹è¯•ç”¨ä¾‹çš„å®Œæ•´ä¿¡æ¯
- å•è½®å’Œå¤šè½®å¯¹è¯æ··åˆ

#### ğŸ“‹ multi_turn_test_cases.json - å¤šè½®æµ‹è¯•ç”¨ä¾‹
- ä¸“é—¨çš„å¤šè½®å¯¹è¯æµ‹è¯•æ•°æ®
- åŒ…å«å¤šè½®ä¸Šä¸‹æ–‡ä¾èµ–çš„æµ‹è¯•åœºæ™¯

#### ğŸ“‹ test_chat_dataset.xlsx - Excelæ ¼å¼æµ‹è¯•æ•°æ®
- åŸå§‹çš„Excelæµ‹è¯•æ•°æ®é›†
- åŒ…å«æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹çš„è¯¦ç»†ä¿¡æ¯

#### ğŸ“‹ å¤šè½®.xlsx - å¤šè½®å¯¹è¯Excelæ•°æ®
- å¤šè½®æµ‹è¯•çš„Excelæ ¼å¼æºæ•°æ®

---

### ğŸ“ˆ ç»“æœæ–‡ä»¶

#### ğŸ“Š test_results_*.json - æµ‹è¯•ç»“æœ
**å‘½åè§„åˆ™**:
- **test_results_all_44_*.json**: åŸå§‹æµ‹è¯•ç»“æœï¼ˆ44ä¸ªï¼‰
- **test_results_all_74_*.json**: æ‰©å±•æµ‹è¯•ç»“æœï¼ˆ74ä¸ªï¼‰
- **test_results_intermediate_*.json**: ä¸­é—´ç»“æœï¼ˆæ¯20ä¸ªæµ‹è¯•ä¿å­˜ä¸€æ¬¡ï¼‰
- **test_results_merged_*.json**: åˆå¹¶åçš„æµå¼æ•°æ®

#### ğŸ“Š validation_report_*.json - éªŒè¯æŠ¥å‘Š
**å‘½åè§„åˆ™**:
- **validation_report_YYYYMMDD_HHMMSS.json**: åŸºæœ¬éªŒè¯æŠ¥å‘Š
- **validation_report_*_gemini*.json**: GeminiéªŒè¯æŠ¥å‘Š
- **validation_report_*_doubao*.json**: DoubaoéªŒè¯æŠ¥å‘Š
- **validation_report_*_qwen*.json**: QwenéªŒè¯æŠ¥å‘Š

#### ğŸ“Š validation_f1_analysis_*.json - F1åˆ†ææŠ¥å‘Š
- ä¸‰ä¸ªæ¨¡å‹çš„F1åˆ†æ•°å¯¹æ¯”åˆ†æ
- åŒ…å«å‡†ç¡®ç‡ã€å¬å›ç‡ã€F1åˆ†æ•°ç­‰æŒ‡æ ‡

---

### ğŸ“– æ–‡æ¡£æ–‡ä»¶

#### ğŸ“„ README_PIPELINE.md - æµæ°´çº¿è¯¦ç»†æ–‡æ¡£
- å®Œæ•´çš„æµæ°´çº¿ä½¿ç”¨è¯´æ˜
- è¯¦ç»†çš„å‚æ•°è§£é‡Šå’Œç¤ºä¾‹

#### ğŸ“„ readme.txt - æœ¬æ–‡ä»¶
- é¡¹ç›®ç›®å½•å’Œæ–‡ä»¶è¯´æ˜
- å¿«é€Ÿä½¿ç”¨æŒ‡å—

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œå®Œæ•´è¯„ä¼°æµæ°´çº¿
```bash
python run_evaluation_pipeline.py
```

### 2. å•ç‹¬è¿è¡Œæµ‹è¯•
```bash
python test_all_cases.py --limit 10
```

### 3. éªŒè¯æµ‹è¯•ç»“æœ
```bash
python validate_test_gemini_results.py
```

### 4. è®¡ç®—F1åˆ†æ•°
```bash
python calculate_validation_f1.py
```

---

## ğŸ“‹ Status vs Is_correct åŒºåˆ«

### Statusï¼ˆéªŒè¯è¿‡ç¨‹çŠ¶æ€ï¼‰
- **"success"**: æ‰€æœ‰turnéªŒè¯æˆåŠŸ âœ…
- **"failed"**: éªŒè¯å¤±è´¥ï¼ˆç½‘ç»œã€è§£æç­‰é”™è¯¯ï¼‰âŒ
- **"partial"**: éƒ¨åˆ†turnéªŒè¯æˆåŠŸ âš ï¸

### Is_correctï¼ˆä¸šåŠ¡é€»è¾‘åˆ¤æ–­ï¼‰
- **"æ­£ç¡®"**: ä¸šåŠ¡é€»è¾‘æ­£ç¡® âœ…
- **"é”™è¯¯"**: ä¸šåŠ¡é€»è¾‘é”™è¯¯ âŒ
- **"unknown"**: æ— æ³•åˆ¤æ–­ âš ï¸

### é‡è¯•æœºåˆ¶
åªé‡è¯• `status != "success"` çš„ç”¨ä¾‹ï¼Œä¸é‡è¯• `is_correct == "é”™è¯¯"` çš„ç”¨ä¾‹ã€‚

---

## ğŸ“ æµ‹è¯•ç”¨ä¾‹æ ¼å¼

æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹åŒ…å«ï¼š
- **id**: æµ‹è¯•ç”¨ä¾‹å”¯ä¸€æ ‡è¯†
- **user_id**: æµ‹è¯•ç”¨æˆ·IDï¼ˆç¡®ä¿æ•°æ®éš”ç¦»ï¼‰
- **mode**: æµ‹è¯•æ¨¡å¼ï¼ˆsingle_turn/multi_turnï¼‰
- **conversation**: å¯¹è¯å†…å®¹
  - **turns**: è½®æ¬¡åˆ—è¡¨
    - **user_input**: ç”¨æˆ·è¾“å…¥
      - **type**: è¾“å…¥ç±»å‹ï¼ˆtext/imageï¼‰
      - **content**: è¾“å…¥å†…å®¹
    - **expected_behavior**: æœŸæœ›è¡Œä¸º
      - **steps**: æ‰§è¡Œæ­¥éª¤ï¼ˆä¼ ç»Ÿæ ¼å¼ï¼‰
      - **paths**: æ‰§è¡Œè·¯å¾„åˆ—è¡¨ï¼ˆæ–°æ ¼å¼ï¼Œæ”¯æŒå¤šè·¯å¾„ï¼‰

---

## ğŸ” é”™è¯¯æ’æŸ¥

### å¸¸è§é”™è¯¯
1. **è¿æ¥é”™è¯¯**: æ£€æŸ¥APIæœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
2. **å›¾ç‰‡åŠ è½½å¤±è´¥**: æ£€æŸ¥images/ç›®å½•ä¸‹çš„å›¾ç‰‡æ–‡ä»¶
3. **è·¯å¾„é”™è¯¯**: è„šæœ¬ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œç¡®ä¿åœ¨æ­£ç¡®ç›®å½•è¿è¡Œ
4. **JSONåºåˆ—åŒ–é”™è¯¯**: ç¡®ä¿Pathå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²

### æ—¥å¿—æŸ¥çœ‹
- æµæ°´çº¿æ—¥å¿—: pipline_results/runs_*/logs/
- éªŒè¯æ—¥å¿—: logs/validation_*.txt
- è¯¦ç»†æŠ¥å‘Š: validation_reports/validation_report_*.json

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
1. logs/ç›®å½•ä¸‹çš„è¯¦ç»†æ—¥å¿—
2. validation_reports/ç›®å½•ä¸‹çš„éªŒè¯æŠ¥å‘Š
3. pipline_results/ç›®å½•ä¸‹çš„æµæ°´çº¿æ‰§è¡Œç»“æœ

---

## ğŸ“… æ›´æ–°å†å²

- **v1.0**: åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒ44ä¸ªæµ‹è¯•ç”¨ä¾‹
- **v2.0**: æ‰©å±•åˆ°74ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œæ·»åŠ å¤šè½®å¯¹è¯æ”¯æŒ
- **v3.0**: æ”¯æŒ101ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå¢å¼ºå¤šè·¯å¾„éªŒè¯
- **å½“å‰**: æ”¯æŒåŠ¨æ€è·¯å¾„ã€æ™ºèƒ½é‡è¯•æœºåˆ¶ã€F1åˆ†æ•°å¯¹æ¯”

---

**æœ€åæ›´æ–°**: 2026-01-23
**é¡¹ç›®ç‰ˆæœ¬**: v3.0
